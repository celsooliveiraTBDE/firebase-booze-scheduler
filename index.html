<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Drink Your Booze Time</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/flatly/bootstrap.min.css">
    <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" /> -->
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.0/moment.js"></script>
    <!-- <script src="assets/javascript/script.js"></script> -->
</head>
<!-- Begin body -->
<body>
    <div class="container">
        <div class="jumbotron">
            <h1 class="display-4">Booze Time</h1>
            <p class="lead">Drink. Mix. Repeat.</p>
            <hr class="my-4">
        </div>    
            <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Draaaanks</h3>
                    </div>
                    <div class="panel-body">
                
            <table class="table">
                
                <thead class="thead-light">
                  <tr>
                    <th scope="col">Drink Name</th>
                    <th scope="col">Spirit</th>
                    <th scope="col">Frequency (min)</th>
                    <th scope="col">Next Order</th>
                    <th scope="col">Minutes Away</th>
                </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">Margarita</th>
                    <td>Tequila</td>
                    <td>5</td>
                    <td>05:35PM</td>
                    <td>5</td>

                  </tr>
                  <tr>
                    <th scope="row">Old Fashioned</th>
                    <td>Whiskey</td>
                    <td>10</td>
                    <td>05:40PM</td>
                    <td>10</td>

                  </tr>
                  <tr>
                    <th scope="row">Manhattan</th>
                    <td>Whiskey</td>
                    <td>15</td>
                    <td>05:45PM</td>
                    <td>15</td>

                  </tr>
                </tbody>
              </table>
            </div></div>
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">Enter New Drink</h3>
        </div>
        <div class="panel-body">
        
    <form>
        <div class="form-group">
          <label for="exampleFormControlInput1">Drink Name</label>
          <input type="text" class="form-control" id="new-drink" >
        </div>
        <div class="form-group">
            <label for="exampleFormControlInput1">Spirit</label>
            <input type="text" class="form-control" id="new-spirit" >
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1">Frequency</label>
            <input type="text" class="form-control" id="new-frequency" >
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1">Last Order</label>
            <input type="text" class="form-control" id="new-next-order" >
          </div>
          <button type="button" class="btn btn-primary">Submit</button>
    </form>
    </div></div>
</div>    
   
    </body>
</html>
<!-- BEGIN SCRIPT - temp -->

<script>
    // Initialize Firebase
    // This is the code to be changed with the new config
    var config = {
        apiKey: "AIzaSyCmVW4eKe9yTYWeAV2mMYIh-QDBr68dB5A",
        authDomain: "fir-booze-schedule.firebaseapp.com",
        databaseURL: "https://fir-booze-schedule.firebaseio.com",
        projectId: "fir-booze-schedule",
        storageBucket: "fir-booze-schedule.appspot.com",
        messagingSenderId: "52144854948"
    };

    firebase.initializeApp(config);
    var database = firebase.database(); 
    database.ref().orderByChild("dateSubmitted").on("child_added", function (snapshot){
            var result =snapshot.val(); 
            console.log(result+"this is result");

    $.each( database.ref(), function( key, value ) {
  console.log( key + ": " + value );
});


    // JAVASCRIPT BEGINS WITH JQUERY CLICK EVENT

    $(".btn-primary").on("click",(function(){

        console.log("This is the button click")
        var newDrink = $( "#new-drink" ).val().trim();
        var newSpirit = $( "#new-spirit" ).val().trim();
        var newFrequency = $( "#new-frequency" ).val().trim();
        var newNextOrder = $( "#new-next-order" ).val().trim();
        console.log("these are the form variables"+newDrink+"spirit="+newSpirit+"frequency="+newFrequency+"newNextOrder="+newNextOrder);
        
//OBJECT STORED IN DATABASE; 
        database.ref().push({
            newDrink: newDrink,
            newSpirit: newSpirit, 
            newFrequency: newFrequency, 
            newNextOrder: newNextOrder,
            dateSubmitted: firebase.database.ServerValue.TIMESTAMP
        });
        database.ref().orderByChild("dateSubmitted").on("child_added", function (snapshot){
            var result =snapshot.val(); 
            console.log(result+"this is result");

            var drinkrow = $("<tr>");
                drinkrow.append("<td>" + result.newDrink + "</td>").append("<td>" + result.newSpirit + "</td>")
                .append("<td>" + result.newFrequency + "</td>").append("<td>" + result.newNextOrder + "</td>");
                $("tbody").append(drinkrow);

        })

    })); 

</script>